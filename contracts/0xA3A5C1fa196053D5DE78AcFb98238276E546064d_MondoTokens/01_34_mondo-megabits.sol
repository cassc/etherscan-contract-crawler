// SPDX-License-Identifier: MIT
pragma solidity ^0.8.16;

import "@openzeppelin/contracts/token/ERC1155/ERC1155.sol";
import "@openzeppelin/contracts/token/common/ERC2981.sol";
import "@openzeppelin/contracts/security/Pausable.sol";
import "@openzeppelin/contracts/access/AccessControlEnumerable.sol";
import "@openzeppelin/contracts/security/ReentrancyGuard.sol";
import "@openzeppelin/contracts/utils/cryptography/MerkleProof.sol";
import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";
import "@openzeppelin/contracts/utils/Address.sol";

import "./mondo-marketplace.sol";

contract MondoTokens is ERC1155, ERC2981, Pausable, AccessControlEnumerable, ReentrancyGuard {
    /* ========================================================================================== */
    /*                                            ROLES                                           */
    /* ========================================================================================== */
    bytes32 public constant PAUSER_ROLE = keccak256("PAUSER_ROLE");
    bytes32 public constant WITHDRAWER_ROLE = keccak256("WITHDRAWER_ROLE");

    /* --------------------------------------- MARKETPLACE -------------------------------------- */
    MondoMarketplace public _mondoMarketplace;

    /* ========================================================================================== */
    /*                                     MINTING INFORMATION                                    */
    /* ========================================================================================== */
    enum MintingStatus {
        WAITING,
        PAUSED,
        STANDARD,
        ADVANCED,
        DONE
    }

    MintingStatus public mintingStatus = MintingStatus.WAITING;

    // Merkle root for the whitelist
    bytes32 public root = 0x36a3f277fab998f2083548bd5c2787cfea178f0898274a95941a60a2c72a3ca4;

    // Signer address for verifying signatures
    address public signer = 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266;

    string public constant PROVENANCE_RECORD = "magnet:?xt=urn:btih:000519fbe6f5ffb26f9d505b334265aa0f8b58c3&dn=Mondo%20Megabits%20Drop%201%20-%20Fake%20Tech";

    // Total supply
    uint256 public constant TOTAL_COPIES_EVER = 4038;

    uint256 public totalMinted = 0;

    bool public whitelistEnabled = true;

    // Maximum minted tokens for a single address
    uint8 public maxMintCountPerAddress = 5;

    // Tokens to be minted.
    // Using uint8 because it will be packed to be smaller so that it's possible to fit this many numbers.
    // Gas will be higher due to packing after modifying a storage variable that doesn't take up a full slot.
    // We have to make this tradeoff though.
    uint8[] tokenPool = [
        63,
        11,
        80,
        81,
        42,
        100,
        55,
        60,
        75,
        28,
        16,
        86,
        96,
        81,
        22,
        39,
        62,
        93,
        83,
        5,
        65,
        31,
        25,
        5,
        22,
        29,
        47,
        51,
        12,
        62,
        84,
        100,
        96,
        20,
        100,
        73,
        70,
        51,
        42,
        97,
        29,
        44,
        75,
        55,
        89,
        60,
        49,
        67,
        87,
        93,
        99,
        57,
        34,
        94,
        24,
        45,
        27,
        99,
        55,
        95,
        48,
        23,
        66,
        84,
        20,
        22,
        6,
        80,
        37,
        73,
        52,
        95,
        3,
        96,
        55,
        90,
        13,
        27,
        80,
        89,
        100,
        39,
        63,
        58,
        94,
        45,
        2,
        72,
        60,
        5,
        85,
        16,
        36,
        19,
        14,
        59,
        55,
        7,
        90,
        10,
        83,
        73,
        75,
        89,
        81,
        32,
        51,
        23,
        6,
        93,
        15,
        49,
        100,
        97,
        20,
        51,
        34,
        53,
        56,
        59,
        22,
        75,
        30,
        63,
        42,
        13,
        65,
        12,
        10,
        2,
        3,
        32,
        100,
        90,
        2,
        73,
        19,
        89,
        63,
        89,
        75,
        21,
        55,
        53,
        75,
        95,
        94,
        83,
        85,
        77,
        75,
        58,
        70,
        76,
        41,
        64,
        15,
        97,
        81,
        19,
        32,
        78,
        3,
        35,
        65,
        40,
        33,
        83,
        29,
        43,
        71,
        66,
        61,
        92,
        129,
        13,
        62,
        35,
        12,
        80,
        33,
        28,
        19,
        33,
        85,
        54,
        88,
        54,
        75,
        91,
        10,
        29,
        73,
        55,
        26,
        89,
        49,
        31,
        96,
        81,
        55,
        13,
        100,
        28,
        6,
        10,
        4,
        88,
        49,
        25,
        66,
        85,
        72,
        30,
        67,
        60,
        64,
        26,
        8,
        44,
        65,
        49,
        94,
        81,
        68,
        4,
        68,
        1,
        77,
        16,
        90,
        53,
        42,
        67,
        21,
        73,
        18,
        62,
        21,
        49,
        53,
        92,
        22,
        32,
        42,
        58,
        89,
        72,
        44,
        6,
        38,
        45,
        44,
        34,
        63,
        27,
        91,
        70,
        35,
        37,
        9,
        45,
        53,
        87,
        27,
        10,
        49,
        83,
        30,
        89,
        57,
        55,
        31,
        71,
        4,
        87,
        4,
        73,
        94,
        7,
        9,
        81,
        88,
        70,
        42,
        49,
        22,
        29,
        27,
        77,
        27,
        32,
        52,
        29,
        73,
        21,
        62,
        37,
        78,
        18,
        32,
        34,
        14,
        4,
        85,
        19,
        22,
        39,
        39,
        81,
        84,
        91,
        75,
        35,
        27,
        60,
        67,
        6,
        86,
        53,
        49,
        90,
        94,
        33,
        117,
        22,
        3,
        71,
        93,
        32,
        69,
        21,
        36,
        84,
        37,
        6,
        29,
        27,
        2,
        29,
        28,
        8,
        79,
        63,
        84,
        5,
        13,
        86,
        79,
        94,
        75,
        51,
        75,
        2,
        4,
        90,
        16,
        45,
        47,
        49,
        42,
        65,
        17,
        2,
        49,
        93,
        36,
        31,
        54,
        27,
        19,
        25,
        22,
        84,
        27,
        36,
        86,
        99,
        63,
        66,
        25,
        87,
        4,
        92,
        89,
        88,
        7,
        32,
        7,
        87,
        34,
        7,
        25,
        11,
        55,
        23,
        39,
        21,
        10,
        22,
        28,
        76,
        44,
        76,
        78,
        67,
        78,
        64,
        60,
        22,
        85,
        99,
        60,
        93,
        47,
        44,
        95,
        91,
        84,
        63,
        7,
        75,
        21,
        93,
        54,
        27,
        99,
        30,
        89,
        32,
        6,
        32,
        5,
        87,
        47,
        30,
        11,
        81,
        86,
        12,
        68,
        32,
        62,
        89,
        7,
        79,
        13,
        7,
        12,
        87,
        96,
        63,
        25,
        6,
        38,
        15,
        100,
        94,
        13,
        64,
        32,
        81,
        57,
        110,
        34,
        83,
        90,
        3,
        94,
        28,
        49,
        12,
        97,
        76,
        34,
        23,
        75,
        94,
        95,
        5,
        44,
        24,
        7,
        96,
        81,
        77,
        1,
        95,
        85,
        96,
        81,
        2,
        29,
        10,
        71,
        34,
        96,
        28,
        42,
        24,
        91,
        54,
        44,
        28,
        62,
        59,
        56,
        49,
        25,
        8,
        66,
        2,
        30,
        86,
        95,
        99,
        14,
        85,
        7,
        3,
        100,
        27,
        78,
        6,
        92,
        26,
        11,
        61,
        12,
        7,
        13,
        99,
        52,
        76,
        49,
        106,
        35,
        29,
        78,
        49,
        28,
        33,
        3,
        105,
        7,
        68,
        69,
        34,
        6,
        12,
        73,
        88,
        55,
        54,
        68,
        14,
        63,
        62,
        47,
        73,
        33,
        60,
        89,
        36,
        42,
        12,
        27,
        120,
        3,
        85,
        10,
        57,
        89,
        9,
        66,
        31,
        15,
        83,
        32,
        22,
        16,
        81,
        29,
        71,
        8,
        16,
        25,
        65,
        96,
        51,
        64,
        70,
        90,
        68,
        7,
        7,
        76,
        64,
        13,
        7,
        94,
        52,
        56,
        20,
        73,
        63,
        49,
        7,
        71,
        31,
        27,
        52,
        39,
        27,
        89,
        14,
        24,
        22,
        80,
        20,
        54,
        68,
        42,
        11,
        39,
        44,
        2,
        75,
        17,
        23,
        99,
        92,
        68,
        5,
        90,
        72,
        81,
        76,
        10,
        49,
        23,
        47,
        73,
        81,
        85,
        59,
        25,
        71,
        67,
        90,
        36,
        94,
        63,
        90,
        76,
        39,
        69,
        30,
        69,
        24,
        100,
        42,
        43,
        55,
        43,
        34,
        14,
        6,
        90,
        67,
        67,
        6,
        51,
        5,
        51,
        60,
        22,
        91,
        83,
        39,
        29,
        69,
        19,
        34,
        11,
        73,
        32,
        21,
        45,
        78,
        16,
        59,
        77,
        52,
        97,
        31,
        4,
        44,
        17,
        13,
        25,
        42,
        30,
        28,
        91,
        33,
        91,
        69,
        6,
        56,
        2,
        6,
        12,
        39,
        86,
        68,
        15,
        66,
        10,
        9,
        52,
        75,
        99,
        25,
        12,
        56,
        83,
        5,
        52,
        16,
        37,
        35,
        18,
        32,
        90,
        49,
        71,
        9,
        26,
        51,
        7,
        63,
        62,
        44,
        73,
        16,
        71,
        99,
        23,
        42,
        6,
        33,
        19,
        85,
        33,
        100,
        23,
        96,
        21,
        76,
        34,
        13,
        51,
        30,
        30,
        42,
        27,
        11,
        54,
        88,
        15,
        6,
        88,
        11,
        80,
        18,
        35,
        12,
        15,
        9,
        39,
        37,
        68,
        99,
        44,
        83,
        8,
        30,
        28,
        94,
        21,
        87,
        6,
        24,
        35,
        54,
        75,
        16,
        58,
        97,
        92,
        39,
        62,
        35,
        52,
        3,
        78,
        48,
        97,
        59,
        79,
        88,
        76,
        7,
        37,
        83,
        3,
        22,
        79,
        22,
        64,
        85,
        68,
        34,
        26,
        31,
        75,
        32,
        7,
        70,
        93,
        47,
        44,
        62,
        96,
        5,
        99,
        91,
        84,
        3,
        86,
        47,
        75,
        85,
        9,
        51,
        80,
        39,
        6,
        32,
        11,
        64,
        57,
        48,
        95,
        47,
        85,
        36,
        28,
        39,
        81,
        57,
        75,
        78,
        73,
        42,
        55,
        35,
        92,
        65,
        36,
        5,
        66,
        69,
        8,
        19,
        87,
        69,
        6,
        92,
        86,
        94,
        37,
        19,
        28,
        75,
        72,
        52,
        88,
        62,
        65,
        52,
        13,
        62,
        2,
        68,
        96,
        32,
        7,
        60,
        86,
        44,
        69,
        86,
        22,
        87,
        6,
        2,
        16,
        5,
        70,
        16,
        75,
        47,
        13,
        90,
        52,
        12,
        28,
        71,
        8,
        23,
        67,
        92,
        70,
        75,
        73,
        54,
        89,
        14,
        6,
        80,
        44,
        70,
        95,
        3,
        75,
        73,
        71,
        37,
        6,
        1,
        81,
        25,
        33,
        88,
        15,
        29,
        93,
        93,
        14,
        100,
        81,
        100,
        44,
        34,
        37,
        6,
        12,
        18,
        36,
        4,
        20,
        86,
        38,
        4,
        83,
        4,
        75,
        52,
        49,
        100,
        62,
        33,
        22,
        11,
        13,
        62,
        100,
        44,
        71,
        16,
        47,
        67,
        47,
        6,
        81,
        22,
        31,
        66,
        31,
        12,
        78,
        54,
        94,
        44,
        39,
        93,
        95,
        86,
        20,
        61,
        87,
        12,
        18,
        23,
        76,
        10,
        71,
        36,
        39,
        65,
        57,
        66,
        63,
        54,
        26,
        72,
        16,
        26,
        100,
        60,
        4,
        53,
        95,
        75,
        62,
        43,
        18,
        55,
        32,
        65,
        66,
        75,
        27,
        2,
        3,
        17,
        77,
        54,
        47,
        83,
        27,
        26,
        11,
        63,
        35,
        89,
        78,
        63,
        91,
        75,
        17,
        36,
        75,
        30,
        44,
        92,
        111,
        47,
        14,
        1,
        78,
        125,
        86,
        33,
        92,
        8,
        84,
        81,
        35,
        100,
        66,
        55,
        48,
        62,
        17,
        35,
        9,
        69,
        87,
        91,
        37,
        63,
        39,
        4,
        37,
        88,
        23,
        70,
        28,
        86,
        87,
        93,
        9,
        21,
        92,
        51,
        34,
        62,
        83,
        84,
        28,
        99,
        18,
        11,
        26,
        89,
        19,
        29,
        49,
        92,
        73,
        39,
        32,
        75,
        28,
        63,
        95,
        35,
        38,
        90,
        20,
        2,
        89,
        87,
        19,
        39,
        55,
        76,
        76,
        28,
        10,
        26,
        30,
        65,
        56,
        43,
        25,
        53,
        84,
        34,
        53,
        77,
        46,
        67,
        85,
        90,
        29,
        48,
        85,
        77,
        75,
        90,
        90,
        6,
        24,
        69,
        21,
        49,
        54,
        73,
        15,
        86,
        97,
        65,
        7,
        52,
        76,
        7,
        88,
        6,
        34,
        87,
        9,
        1,
        69,
        60,
        70,
        25,
        11,
        15,
        85,
        10,
        7,
        42,
        70,
        21,
        32,
        58,
        15,
        68,
        28,
        49,
        7,
        44,
        47,
        62,
        26,
        26,
        89,
        29,
        60,
        17,
        49,
        19,
        29,
        57,
        87,
        81,
        30,
        95,
        21,
        73,
        93,
        74,
        60,
        28,
        22,
        32,
        34,
        73,
        52,
        87,
        62,
        4,
        100,
        87,
        22,
        93,
        98,
        14,
        54,
        86,
        77,
        17,
        34,
        29,
        86,
        6,
        42,
        34,
        28,
        87,
        70,
        65,
        103,
        60,
        4,
        13,
        87,
        43,
        88,
        72,
        3,
        29,
        36,
        90,
        49,
        73,
        76,
        88,
        48,
        83,
        92,
        102,
        52,
        28,
        96,
        6,
        39,
        63,
        31,
        44,
        47,
        92,
        81,
        90,
        27,
        33,
        33,
        30,
        38,
        30,
        70,
        93,
        100,
        75,
        39,
        87,
        84,
        62,
        21,
        86,
        80,
        84,
        66,
        3,
        91,
        28,
        100,
        87,
        13,
        60,
        63,
        93,
        35,
        34,
        33,
        68,
        5,
        7,
        63,
        95,
        124,
        99,
        38,
        58,
        89,
        92,
        44,
        64,
        73,
        49,
        20,
        36,
        88,
        32,
        69,
        42,
        81,
        6,
        63,
        92,
        36,
        9,
        13,
        12,
        35,
        57,
        34,
        99,
        27,
        11,
        29,
        21,
        93,
        31,
        60,
        86,
        75,
        95,
        90,
        91,
        91,
        100,
        80,
        5,
        58,
        93,
        84,
        89,
        57,
        16,
        67,
        94,
        62,
        53,
        118,
        89,
        70,
        39,
        85,
        64,
        25,
        94,
        9,
        88,
        10,
        63,
        37,
        1,
        83,
        10,
        27,
        15,
        29,
        94,
        29,
        44,
        51,
        73,
        55,
        6,
        24,
        10,
        89,
        29,
        28,
        73,
        25,
        71,
        26,
        22,
        10,
        95,
        30,
        42,
        20,
        5,
        54,
        114,
        5,
        42,
        36,
        115,
        45,
        72,
        31,
        29,
        79,
        79,
        5,
        44,
        97,
        23,
        35,
        53,
        87,
        62,
        81,
        70,
        49,
        97,
        68,
        108,
        26,
        61,
        29,
        97,
        63,
        45,
        80,
        89,
        38,
        79,
        35,
        70,
        2,
        27,
        57,
        5,
        55,
        21,
        90,
        61,
        52,
        65,
        100,
        49,
        20,
        58,
        4,
        79,
        75,
        81,
        3,
        19,
        76,
        87,
        89,
        44,
        64,
        73,
        23,
        95,
        35,
        99,
        4,
        76,
        42,
        26,
        94,
        39,
        37,
        49,
        90,
        83,
        92,
        100,
        12,
        88,
        37,
        9,
        48,
        13,
        6,
        86,
        8,
        4,
        78,
        64,
        37,
        39,
        19,
        38,
        30,
        27,
        6,
        28,
        83,
        29,
        32,
        9,
        86,
        19,
        20,
        94,
        31,
        13,
        9,
        80,
        2,
        19,
        80,
        68,
        19,
        69,
        49,
        13,
        31,
        70,
        16,
        16,
        93,
        76,
        66,
        92,
        29,
        33,
        17,
        51,
        28,
        52,
        39,
        1,
        22,
        30,
        54,
        126,
        48,
        16,
        90,
        51,
        65,
        35,
        81,
        36,
        64,
        76,
        25,
        88,
        78,
        83,
        4,
        87,
        95,
        26,
        36,
        95,
        69,
        79,
        13,
        54,
        6,
        87,
        9,
        62,
        68,
        22,
        76,
        3,
        30,
        34,
        52,
        11,
        49,
        37,
        33,
        69,
        81,
        78,
        65,
        11,
        29,
        71,
        14,
        27,
        73,
        89,
        53,
        6,
        23,
        73,
        51,
        36,
        91,
        45,
        67,
        79,
        91,
        2,
        61,
        35,
        73,
        44,
        66,
        9,
        19,
        12,
        69,
        93,
        29,
        47,
        89,
        61,
        6,
        28,
        27,
        67,
        35,
        89,
        7,
        62,
        28,
        99,
        24,
        94,
        7,
        71,
        21,
        81,
        69,
        85,
        81,
        71,
        73,
        26,
        88,
        12,
        32,
        85,
        84,
        78,
        28,
        3,
        51,
        65,
        5,
        44,
        39,
        35,
        13,
        83,
        84,
        33,
        77,
        35,
        93,
        9,
        59,
        68,
        76,
        27,
        20,
        19,
        27,
        81,
        59,
        79,
        64,
        73,
        95,
        85,
        77,
        5,
        78,
        75,
        51,
        4,
        24,
        54,
        13,
        33,
        70,
        75,
        11,
        24,
        83,
        3,
        79,
        19,
        97,
        79,
        34,
        95,
        35,
        85,
        33,
        60,
        61,
        85,
        69,
        84,
        96,
        97,
        80,
        69,
        13,
        73,
        37,
        94,
        96,
        75,
        22,
        94,
        60,
        90,
        20,
        6,
        91,
        11,
        75,
        21,
        16,
        93,
        94,
        17,
        97,
        31,
        64,
        75,
        66,
        1,
        58,
        81,
        100,
        49,
        34,
        62,
        59,
        6,
        19,
        100,
        30,
        3,
        71,
        86,
        79,
        57,
        62,
        91,
        29,
        87,
        100,
        94,
        49,
        39,
        28,
        93,
        66,
        5,
        38,
        29,
        27,
        5,
        25,
        54,
        89,
        71,
        92,
        91,
        88,
        51,
        33,
        99,
        72,
        30,
        54,
        89,
        55,
        35,
        54,
        49,
        4,
        84,
        83,
        82,
        68,
        32,
        90,
        21,
        2,
        32,
        53,
        53,
        24,
        33,
        33,
        37,
        64,
        53,
        1,
        78,
        84,
        39,
        19,
        99,
        33,
        7,
        16,
        97,
        99,
        13,
        21,
        70,
        63,
        72,
        104,
        28,
        59,
        66,
        80,
        39,
        22,
        6,
        13,
        85,
        26,
        72,
        20,
        28,
        86,
        70,
        58,
        63,
        100,
        8,
        88,
        90,
        52,
        70,
        85,
        81,
        5,
        21,
        22,
        85,
        32,
        35,
        31,
        78,
        22,
        70,
        84,
        90,
        53,
        8,
        22,
        68,
        83,
        64,
        27,
        30,
        95,
        29,
        96,
        91,
        83,
        64,
        89,
        39,
        78,
        85,
        87,
        23,
        26,
        53,
        3,
        8,
        64,
        96,
        14,
        26,
        67,
        1,
        63,
        69,
        83,
        97,
        55,
        18,
        31,
        52,
        83,
        75,
        94,
        55,
        36,
        62,
        7,
        35,
        68,
        93,
        57,
        3,
        85,
        75,
        99,
        85,
        27,
        1,
        9,
        57,
        62,
        90,
        39,
        34,
        6,
        66,
        37,
        7,
        85,
        71,
        54,
        86,
        69,
        25,
        27,
        99,
        51,
        34,
        16,
        30,
        95,
        70,
        99,
        94,
        62,
        73,
        100,
        62,
        22,
        85,
        49,
        4,
        35,
        73,
        84,
        109,
        71,
        45,
        68,
        14,
        11,
        27,
        38,
        97,
        52,
        36,
        80,
        100,
        62,
        12,
        3,
        16,
        35,
        15,
        32,
        24,
        79,
        55,
        51,
        84,
        26,
        43,
        49,
        7,
        32,
        94,
        70,
        43,
        83,
        96,
        35,
        52,
        94,
        5,
        13,
        66,
        61,
        48,
        1,
        25,
        64,
        64,
        14,
        5,
        91,
        14,
        3,
        85,
        15,
        6,
        4,
        63,
        96,
        5,
        27,
        100,
        94,
        29,
        23,
        101,
        5,
        56,
        90,
        2,
        14,
        31,
        76,
        2,
        100,
        28,
        92,
        97,
        1,
        19,
        33,
        77,
        83,
        52,
        4,
        23,
        8,
        33,
        34,
        16,
        66,
        64,
        31,
        44,
        27,
        80,
        52,
        25,
        38,
        97,
        51,
        89,
        94,
        25,
        25,
        9,
        7,
        12,
        24,
        91,
        26,
        72,
        51,
        34,
        22,
        33,
        97,
        29,
        69,
        21,
        4,
        22,
        89,
        19,
        4,
        44,
        48,
        92,
        62,
        25,
        21,
        67,
        6,
        63,
        96,
        52,
        67,
        92,
        63,
        29,
        95,
        66,
        62,
        51,
        23,
        28,
        95,
        79,
        67,
        52,
        93,
        83,
        35,
        58,
        13,
        51,
        87,
        70,
        79,
        54,
        21,
        96,
        63,
        35,
        2,
        63,
        61,
        73,
        94,
        79,
        19,
        67,
        28,
        60,
        78,
        15,
        29,
        33,
        39,
        71,
        62,
        75,
        33,
        21,
        68,
        79,
        55,
        36,
        52,
        25,
        37,
        12,
        16,
        90,
        31,
        45,
        91,
        9,
        5,
        84,
        94,
        5,
        83,
        30,
        37,
        85,
        33,
        6,
        85,
        30,
        75,
        52,
        33,
        83,
        23,
        94,
        84,
        35,
        60,
        88,
        94,
        25,
        55,
        13,
        38,
        97,
        38,
        23,
        99,
        63,
        100,
        81,
        19,
        37,
        89,
        49,
        7,
        35,
        26,
        86,
        6,
        95,
        2,
        9,
        69,
        97,
        100,
        8,
        34,
        81,
        4,
        69,
        11,
        27,
        37,
        85,
        44,
        38,
        57,
        21,
        65,
        35,
        63,
        69,
        30,
        70,
        55,
        12,
        4,
        16,
        36,
        6,
        33,
        55,
        24,
        100,
        21,
        19,
        94,
        72,
        29,
        94,
        87,
        27,
        38,
        91,
        29,
        51,
        81,
        83,
        94,
        27,
        100,
        95,
        66,
        3,
        90,
        90,
        78,
        3,
        83,
        53,
        73,
        68,
        93,
        31,
        94,
        88,
        39,
        34,
        36,
        71,
        35,
        26,
        66,
        2,
        14,
        69,
        63,
        17,
        64,
        52,
        25,
        61,
        83,
        81,
        81,
        65,
        94,
        96,
        11,
        33,
        2,
        24,
        73,
        34,
        12,
        65,
        36,
        2,
        48,
        43,
        55,
        100,
        17,
        96,
        68,
        52,
        12,
        27,
        54,
        19,
        39,
        69,
        38,
        26,
        33,
        44,
        83,
        54,
        10,
        88,
        80,
        64,
        26,
        68,
        54,
        11,
        76,
        100,
        81,
        57,
        61,
        3,
        14,
        36,
        4,
        32,
        77,
        9,
        11,
        70,
        10,
        84,
        12,
        78,
        83,
        25,
        89,
        64,
        83,
        8,
        66,
        27,
        23,
        10,
        29,
        28,
        53,
        5,
        44,
        97,
        79,
        53,
        85,
        53,
        12,
        11,
        19,
        17,
        33,
        64,
        15,
        85,
        69,
        36,
        31,
        51,
        60,
        22,
        54,
        72,
        54,
        17,
        31,
        57,
        5,
        14,
        60,
        93,
        44,
        92,
        39,
        51,
        34,
        95,
        15,
        32,
        57,
        55,
        34,
        79,
        54,
        6,
        89,
        42,
        17,
        35,
        3,
        51,
        64,
        44,
        13,
        5,
        93,
        75,
        81,
        34,
        47,
        64,
        76,
        95,
        100,
        63,
        58,
        55,
        66,
        59,
        51,
        22,
        12,
        70,
        81,
        49,
        17,
        81,
        1,
        5,
        9,
        85,
        30,
        20,
        15,
        22,
        97,
        80,
        1,
        37,
        75,
        44,
        9,
        51,
        20,
        24,
        62,
        2,
        54,
        89,
        17,
        2,
        70,
        89,
        80,
        19,
        44,
        14,
        29,
        71,
        100,
        20,
        93,
        30,
        44,
        31,
        97,
        83,
        42,
        57,
        13,
        68,
        45,
        94,
        67,
        9,
        37,
        42,
        56,
        99,
        26,
        22,
        62,
        89,
        78,
        35,
        71,
        55,
        33,
        13,
        83,
        30,
        86,
        83,
        5,
        77,
        86,
        8,
        107,
        12,
        69,
        94,
        73,
        31,
        97,
        86,
        26,
        73,
        57,
        37,
        49,
        30,
        88,
        27,
        57,
        13,
        38,
        20,
        39,
        67,
        81,
        81,
        96,
        130,
        94,
        9,
        7,
        85,
        51,
        4,
        33,
        60,
        19,
        35,
        62,
        52,
        4,
        9,
        28,
        36,
        10,
        31,
        22,
        5,
        17,
        63,
        62,
        49,
        2,
        56,
        21,
        49,
        30,
        49,
        33,
        52,
        53,
        95,
        88,
        21,
        60,
        88,
        29,
        67,
        86,
        39,
        68,
        89,
        23,
        25,
        88,
        39,
        36,
        9,
        54,
        2,
        28,
        5,
        10,
        2,
        67,
        75,
        81,
        91,
        97,
        38,
        32,
        94,
        19,
        22,
        51,
        26,
        96,
        12,
        6,
        79,
        62,
        68,
        85,
        34,
        25,
        39,
        14,
        12,
        35,
        83,
        93,
        33,
        112,
        38,
        54,
        94,
        53,
        70,
        97,
        55,
        95,
        32,
        33,
        11,
        85,
        33,
        49,
        76,
        28,
        34,
        73,
        2,
        34,
        86,
        87,
        17,
        43,
        80,
        22,
        33,
        128,
        73,
        61,
        30,
        39,
        26,
        10,
        60,
        20,
        22,
        2,
        6,
        87,
        62,
        67,
        56,
        19,
        76,
        92,
        54,
        69,
        25,
        71,
        55,
        27,
        37,
        6,
        81,
        10,
        10,
        100,
        87,
        43,
        70,
        88,
        86,
        119,
        32,
        64,
        92,
        54,
        90,
        30,
        39,
        89,
        7,
        76,
        94,
        81,
        21,
        27,
        80,
        29,
        9,
        2,
        28,
        86,
        99,
        27,
        72,
        75,
        68,
        29,
        90,
        13,
        47,
        8,
        57,
        51,
        6,
        75,
        27,
        95,
        73,
        13,
        86,
        78,
        77,
        93,
        2,
        20,
        80,
        38,
        38,
        75,
        55,
        85,
        100,
        86,
        70,
        76,
        83,
        91,
        99,
        16,
        60,
        75,
        51,
        73,
        35,
        9,
        5,
        113,
        100,
        73,
        32,
        94,
        13,
        22,
        51,
        78,
        5,
        5,
        6,
        62,
        5,
        95,
        5,
        81,
        8,
        58,
        21,
        52,
        85,
        14,
        97,
        25,
        26,
        7,
        39,
        95,
        76,
        83,
        22,
        67,
        17,
        48,
        88,
        100,
        30,
        27,
        70,
        87,
        33,
        25,
        54,
        8,
        60,
        8,
        7,
        72,
        78,
        65,
        3,
        100,
        36,
        76,
        85,
        13,
        7,
        19,
        70,
        26,
        16,
        78,
        94,
        47,
        87,
        16,
        59,
        2,
        78,
        56,
        6,
        55,
        44,
        65,
        31,
        67,
        49,
        37,
        53,
        11,
        14,
        31,
        62,
        9,
        88,
        58,
        72,
        37,
        9,
        27,
        72,
        19,
        39,
        52,
        70,
        24,
        56,
        34,
        57,
        64,
        34,
        13,
        73,
        53,
        84,
        3,
        55,
        55,
        45,
        45,
        33,
        63,
        73,
        99,
        99,
        44,
        94,
        23,
        62,
        81,
        19,
        33,
        29,
        5,
        27,
        39,
        58,
        39,
        12,
        36,
        16,
        87,
        53,
        5,
        86,
        13,
        70,
        81,
        16,
        2,
        56,
        64,
        22,
        52,
        90,
        22,
        57,
        85,
        13,
        71,
        34,
        55,
        47,
        91,
        76,
        9,
        22,
        57,
        85,
        95,
        32,
        32,
        5,
        71,
        89,
        43,
        63,
        11,
        1,
        18,
        29,
        95,
        13,
        32,
        68,
        71,
        49,
        39,
        48,
        27,
        75,
        39,
        49,
        96,
        68,
        47,
        49,
        68,
        68,
        88,
        70,
        87,
        63,
        68,
        19,
        22,
        28,
        60,
        21,
        70,
        54,
        16,
        67,
        131,
        18,
        11,
        85,
        83,
        89,
        52,
        18,
        26,
        45,
        3,
        29,
        20,
        7,
        58,
        4,
        34,
        1,
        30,
        63,
        86,
        38,
        14,
        76,
        26,
        85,
        78,
        36,
        17,
        88,
        83,
        5,
        34,
        5,
        84,
        34,
        32,
        57,
        7,
        8,
        62,
        36,
        79,
        2,
        62,
        48,
        35,
        3,
        4,
        53,
        72,
        6,
        85,
        49,
        71,
        15,
        60,
        36,
        7,
        99,
        67,
        56,
        44,
        5,
        96,
        26,
        30,
        62,
        57,
        90,
        52,
        58,
        96,
        5,
        31,
        21,
        54,
        7,
        123,
        83,
        99,
        69,
        62,
        54,
        99,
        60,
        86,
        68,
        7,
        31,
        5,
        52,
        33,
        49,
        7,
        87,
        26,
        70,
        83,
        5,
        95,
        42,
        127,
        71,
        30,
        10,
        89,
        48,
        64,
        33,
        11,
        90,
        13,
        9,
        69,
        36,
        36,
        73,
        53,
        13,
        11,
        3,
        2,
        27,
        76,
        67,
        99,
        22,
        5,
        28,
        91,
        52,
        96,
        65,
        68,
        30,
        19,
        75,
        7,
        17,
        4,
        7,
        90,
        33,
        55,
        86,
        23,
        9,
        19,
        52,
        67,
        23,
        16,
        16,
        52,
        79,
        90,
        14,
        71,
        58,
        99,
        100,
        44,
        19,
        81,
        39,
        100,
        88,
        37,
        33,
        5,
        13,
        89,
        59,
        25,
        4,
        75,
        39,
        49,
        83,
        21,
        1,
        44,
        56,
        17,
        100,
        8,
        75,
        4,
        51,
        6,
        87,
        12,
        93,
        90,
        67,
        77,
        100,
        39,
        5,
        30,
        7,
        85,
        53,
        71,
        94,
        31,
        83,
        42,
        32,
        48,
        63,
        70,
        96,
        51,
        71,
        99,
        35,
        100,
        38,
        96,
        71,
        14,
        69,
        85,
        88,
        95,
        29,
        68,
        22,
        23,
        53,
        49,
        63,
        26,
        12,
        48,
        31,
        21,
        33,
        64,
        32,
        59,
        15,
        53,
        52,
        62,
        1,
        55,
        22,
        73,
        47,
        16,
        19,
        61,
        90,
        81,
        65,
        59,
        96,
        86,
        38,
        90,
        84,
        86,
        81,
        27,
        73,
        73,
        66,
        52,
        59,
        76,
        26,
        26,
        86,
        70,
        62,
        87,
        87,
        77,
        16,
        39,
        66,
        39,
        90,
        57,
        44,
        66,
        68,
        8,
        59,
        83,
        16,
        94,
        39,
        19,
        63,
        76,
        69,
        11,
        34,
        35,
        1,
        9,
        83,
        35,
        13,
        68,
        78,
        68,
        88,
        71,
        35,
        9,
        6,
        94,
        78,
        64,
        78,
        88,
        19,
        21,
        34,
        24,
        44,
        57,
        57,
        35,
        100,
        100,
        100,
        47,
        22,
        84,
        39,
        64,
        47,
        28,
        76,
        75,
        17,
        6,
        88,
        88,
        62,
        38,
        78,
        24,
        32,
        84,
        26,
        37,
        44,
        71,
        28,
        69,
        33,
        64,
        9,
        34,
        42,
        90,
        30,
        34,
        91,
        60,
        32,
        60,
        90,
        55,
        29,
        37,
        88,
        73,
        14,
        49,
        86,
        100,
        26,
        19,
        26,
        66,
        95,
        7,
        51,
        26,
        9,
        88,
        38,
        77,
        95,
        5,
        91,
        87,
        62,
        88,
        5,
        91,
        53,
        22,
        12,
        89,
        100,
        90,
        52,
        32,
        73,
        36,
        34,
        90,
        21,
        96,
        66,
        70,
        49,
        34,
        13,
        15,
        95,
        13,
        95,
        92,
        5,
        15,
        67,
        65,
        25,
        88,
        81,
        15,
        90,
        93,
        27,
        32,
        86,
        29,
        76,
        83,
        69,
        22,
        7,
        45,
        69,
        59,
        31,
        70,
        9,
        34,
        55,
        57,
        5,
        57,
        75,
        68,
        11,
        7,
        13,
        33,
        89,
        38,
        22,
        83,
        14,
        22,
        69,
        76,
        54,
        24,
        31,
        99,
        34,
        11,
        29,
        95,
        86,
        8,
        2,
        4,
        67,
        26,
        34,
        38,
        94,
        7,
        49,
        87,
        13,
        16,
        81,
        34,
        57,
        28,
        87,
        26,
        52,
        49,
        79,
        81,
        100,
        71,
        95,
        11,
        35,
        26,
        44,
        91,
        66,
        67,
        29,
        33,
        63,
        52,
        94,
        15,
        79,
        88,
        52,
        1,
        96,
        52,
        21,
        11,
        54,
        87,
        27,
        68,
        70,
        33,
        55,
        68,
        31,
        1,
        96,
        38,
        78,
        21,
        35,
        35,
        36,
        71,
        52,
        57,
        62,
        35,
        12,
        21,
        69,
        25,
        85,
        90,
        42,
        57,
        34,
        33,
        58,
        64,
        52,
        71,
        33,
        69,
        23,
        97,
        76,
        65,
        21,
        55,
        27,
        19,
        85,
        27,
        64,
        27,
        55,
        18,
        16,
        49,
        92,
        70,
        17,
        60,
        9,
        8,
        29,
        96,
        53,
        25,
        79,
        1,
        30,
        95,
        67,
        32,
        79,
        9,
        73,
        11,
        53,
        81,
        96,
        15,
        8,
        23,
        66,
        90,
        7,
        75,
        19,
        78,
        8,
        37,
        13,
        11,
        43,
        11,
        33,
        85,
        30,
        8,
        99,
        73,
        76,
        55,
        52,
        15,
        48,
        37,
        83,
        92,
        16,
        21,
        6,
        57,
        73,
        83,
        94,
        24,
        35,
        15,
        69,
        15,
        57,
        90,
        70,
        39,
        29,
        69,
        81,
        24,
        9,
        80,
        78,
        88,
        52,
        58,
        7,
        62,
        86,
        69,
        78,
        21,
        68,
        31,
        39,
        76,
        100,
        39,
        54,
        52,
        60,
        76,
        44,
        53,
        31,
        91,
        52,
        63,
        99,
        79,
        94,
        3,
        24,
        30,
        76,
        91,
        80,
        63,
        91,
        52,
        95,
        19,
        87,
        27,
        21,
        13,
        35,
        73,
        62,
        67,
        7,
        30,
        53,
        55,
        64,
        56,
        1,
        34,
        1,
        36,
        11,
        63,
        85,
        9,
        73,
        93,
        96,
        54,
        93,
        17,
        26,
        90,
        27,
        85,
        94,
        3,
        64,
        37,
        20,
        76,
        55,
        27,
        43,
        76,
        16,
        66,
        67,
        90,
        7,
        100,
        26,
        54,
        75,
        61,
        81,
        49,
        88,
        6,
        69,
        64,
        88,
        28,
        24,
        10,
        49,
        45,
        54,
        33,
        94,
        2,
        29,
        35,
        85,
        81,
        91,
        65,
        48,
        43,
        93,
        78,
        9,
        11,
        68,
        27,
        22,
        80,
        21,
        10,
        16,
        64,
        73,
        64,
        16,
        25,
        90,
        22,
        16,
        68,
        9,
        45,
        7,
        18,
        90,
        53,
        55,
        22,
        22,
        66,
        21,
        65,
        19,
        1,
        57,
        3,
        35,
        27,
        20,
        93,
        20,
        24,
        96,
        75,
        42,
        18,
        17,
        100,
        95,
        47,
        43,
        24,
        49,
        43,
        55,
        28,
        23,
        86,
        54,
        45,
        30,
        86,
        64,
        95,
        66,
        73,
        10,
        30,
        30,
        53,
        20,
        37,
        14,
        66,
        29,
        52,
        70,
        29,
        93,
        100,
        62,
        87,
        35,
        66,
        76,
        53,
        88,
        73,
        17,
        77,
        63,
        96,
        95,
        49,
        68,
        3,
        88,
        54,
        88,
        60,
        62,
        33,
        21,
        14,
        86,
        13,
        8,
        63,
        12,
        44,
        44,
        70,
        13,
        35,
        80,
        64,
        1,
        20,
        64,
        85,
        21,
        16,
        29,
        28,
        9,
        16,
        21,
        8,
        9,
        39,
        4,
        20,
        68,
        54,
        62,
        5,
        13,
        3,
        57,
        37,
        1,
        76,
        81,
        75,
        39,
        3,
        83,
        121,
        6,
        6,
        66,
        93,
        32,
        24,
        80,
        80,
        17,
        17,
        4,
        78,
        94,
        64,
        57,
        19,
        122,
        83,
        4,
        80,
        60,
        86,
        67,
        35,
        7,
        89,
        99,
        87,
        47,
        1,
        43,
        16,
        83,
        33,
        12,
        61,
        65,
        22,
        68,
        1,
        23,
        29,
        26,
        95,
        60,
        91,
        25,
        47,
        64,
        32,
        87,
        66,
        26,
        31,
        52,
        37,
        92,
        83,
        64,
        25,
        10,
        116,
        91,
        69,
        9,
        55,
        76,
        90,
        29,
        13,
        22,
        16,
        69,
        69,
        61,
        32,
        34,
        61,
        13,
        5,
        13,
        90,
        77,
        83,
        100,
        67,
        67,
        13,
        28,
        28,
        64,
        89,
        93,
        7,
        16
    ];

    // [owner] -> amount they minted
    mapping(address => uint8) public mintCount;

    // [owner] -> nonce
    mapping(address => uint16) public ownerNonces;

    /* ============================================================================================================== */
    /*                                                  CONSTRUCTION                                                  */
    /* ============================================================================================================== */
    constructor() ERC1155("https://metadata.mondomegabits.com/{id}") {
        _grantRole(DEFAULT_ADMIN_ROLE, msg.sender);
        _grantRole(PAUSER_ROLE, msg.sender);
        _grantRole(WITHDRAWER_ROLE, msg.sender);
        _grantRole(WITHDRAWER_ROLE, 0xe87F4610c48E17ee0EE0c72Fe280450CA660399B);

        _setDefaultRoyalty(address(this), 1000);
    }

    bool private hasGiftedTokens = false;

    function giveGiftTokens(uint256[] memory ids, uint256[] memory counts)
        external
        nonReentrant
        onlyRole(DEFAULT_ADMIN_ROLE)
    {
        require(hasGiftedTokens == false, "Already gave tokens");
        hasGiftedTokens = true;

        totalMinted += 80;

        // Gifted cards
        _mint(0x690892db2FA439A703115D36E4205088E0C55D1a, 43, 1, "");
        _mint(0xC2f158234da1956623A0D0E4ceAAcC764A609B81, 61, 1, "");
        _mint(0x06056Dcdc6471439e31e878492f594B6F0D8F9D0, 52, 1, "");
        _mint(0x1be4AB962fbCA955de52450BB78B46052eac0a62, 62, 1, "");
        _mint(0x3cB85f3C1E18f1ec13B425669Cb8F6b7086f1D0C, 50, 1, "");
        _mint(0xcbc808e97dCc154B6e8df4c44f05d9C22011BeD1, 18, 1, "");
        _mint(0x0Faa2615BaC776207034620Bdb87D8F3d032Ac90, 13, 1, "");
        _mint(0x229600cfd8E158A42527E09513BfF42fdFd09Fa8, 94, 1, "");
        _mint(0xA4dD7f4A4BAf918D97ED921Dfd918FD2aeF7e451, 30, 1, "");
        _mint(0x6D8FB06f9233352CBF4F2274F22b13DD3B37015A, 91, 1, "");
        _mint(0xbCB5E08E412Fa901973C638E59eFDA1EcB9Ef354, 48, 1, "");
        _mint(0x8A78cEef8752a7E90c27C4aEAcE13f3C4Af56e33, 91, 1, "");
        _mint(0x7C4a7d85623CdF7bBf67ceaf2b862E3028Fe9aCb, 36, 1, "");
        _mint(0xe873e624431024e46de133987498d45ba9E8A123, 89, 1, "");
        _mint(0xbf67e713ddEf50496c6F27C41Eaeecee3A9FA063, 90, 1, "");
        _mint(0x395ff02870F6C146E2b50512b9755fECb57E83C0, 56, 1, "");
        _mint(0x85dC88dABE0fb9988190B5B228c9Aa5804070864, 69, 1, "");
        _mint(0xAE17e8F2aC7C0B8c3a77d29fF60E73Af1A5Bf089, 43, 1, "");
        _mint(0x19355237CdB7b76bC166E05F6338F270B084ecFc, 76, 1, "");
        _mint(0x524Aa222370690cDc108a2A54d9054dC4C31146c, 72, 1, "");
        _mint(0xb7397e25a2e167941dEd07e605953EE620756a22, 39, 1, "");
        _mint(0xd4D3A6EACF401Fa50033114A6952220D6f60B648, 37, 1, "");
        _mint(0x0e6114613A5e28F628f41Da0Ec204Ca505956be8, 56, 1, "");
        _mint(0x81Ed8BC0C08b6871738b7514C36d347B2cC172E8, 42, 1, "");
        _mint(0xba1a95c258290Ae6A0cbDAbfA8fB6e471a48032F, 12, 1, "");
        _mint(0xEe34a1CcE595270AD3Ecc4D50D34dF978954584c, 20, 1, "");
        _mint(0x448A1BF01d6B7cc9D2c8cD1d05d246bcd840517F, 20, 1, "");
        _mint(0x386Fa68BeF515dab808358935418e37Fa1748C32, 7, 1, "");
        _mint(0x30Da874E35Fbd3a1580ed1E9eFaeEe2E180b4aCD, 90, 1, "");
        _mint(0xbCB5E08E412Fa901973C638E59eFDA1EcB9Ef354, 87, 1, "");
        _mint(0xAE17e8F2aC7C0B8c3a77d29fF60E73Af1A5Bf089, 62, 1, "");
        _mint(0xcAB58f3BacDBe6F8F6e41Ff322ce97b2196024f4, 53, 1, "");
        _mint(0x43D588cb4411e83e860c6166763112e1ccF76EA9, 56, 1, "");
        _mint(0x24Ef7784caC2c628Eef21b98bE9f70044b5e3Be4, 31, 1, "");
        _mint(0xCAC3DDD55551D0ec3176FFb7347C8c290dcb866F, 60, 1, "");
        _mint(0x229600cfd8E158A42527E09513BfF42fdFd09Fa8, 51, 1, "");
        _mint(0x240224AC042e7F0Eb7A16AF0a49907061c9894C8, 65, 1, "");
        _mint(0xDc5CbDF0Ff309b49A332dbFa3264b775c2cAfd09, 85, 1, "");
        _mint(0xB3407C29463951902aeF4a6a87265Ff0263b5689, 99, 1, "");
        _mint(0xe1677D385bC7c62486ED53c7B6CdE63FE9EE1F2d, 85, 1, "");
        _mint(0x1a6763326dE2837048E72190d9842F38ee0C491B, 30, 1, "");
        _mint(0xc665AB82Bae93188D39bF6Aa0c2Cf2ca66Fc66b4, 18, 1, "");
        _mint(0xDF017621ebdFe522dBA6F08A4a1db6E791216ecF, 38, 1, "");
        _mint(0xaA608298eA894013eC76e5D963752bEf6d097a85, 56, 1, "");
        _mint(0xaA608298eA894013eC76e5D963752bEf6d097a85, 52, 1, "");
        _mintBatch(0xd3DEB100f6Be210F29F087b707F29ffa93F7e50A, ids, counts, "");
    }

    /* ========================================================================================== */
    /*                                          METADATA                                          */
    /* ========================================================================================== */
    function contractURI() external pure returns (string memory) {
        return "https://metadata.mondomegabits.com/contract";
    }

    function supportsInterface(bytes4 interfaceId)
        public
        view
        override(ERC1155, ERC2981, AccessControlEnumerable)
        returns (bool)
    {
        return super.supportsInterface(interfaceId);
    }

    /* ============================================================================================================== */
    /*                                         PSEUDORANDOM NUMBER GENERATION                                         */
    /* ============================================================================================================== */

    // Generates a random number from 0 to uint256.max
    function rand() private view returns (uint256) {
        return uint256(keccak256(abi.encodePacked(block.difficulty, block.timestamp)));
    }

    function randomMintIdx() private view returns (uint16) {
        return uint16(rand() % (tokenPool.length));
    }

    /* ============================================================================================================== */
    /*                                                    ROYALTIES                                                   */
    /* ============================================================================================================== */
    uint256 public constant ROYALTY_DIVISOR = 20; // 5% royalties: 1/.05 = 20

    /* ============================================================================================================== */
    /*                                                     MINTING                                                    */
    /* ============================================================================================================== */
    event CardMinted(uint256 id, address owner);

    /* ----------------------------------- START STANDARD MINT ---------------------------------- */

    function verifyLeaf(bytes32[] calldata proof, bytes32 leaf) internal view returns (bool) {
        return MerkleProof.verifyCalldata(proof, root, leaf);
    }

    function mint(uint8 count, bytes32[] calldata proof) external payable returns (uint256[] memory ids) {
        /* ====================================================================================== */
        /*                                         CHECKS                                         */
        /* ====================================================================================== */
        require(mintingStatus == MintingStatus.STANDARD);

        require(msg.value == (.25 ether * count), "Incorrect price.");
        require(tx.origin == msg.sender && !Address.isContract(msg.sender), "Contracts can't mint.");
        require(count > 0, "Must mint at least 1");
        require(totalMinted + count <= TOTAL_COPIES_EVER, "Cannot mint more than total copies ever");
        require(mintCount[msg.sender] + count <= maxMintCountPerAddress, "Above max mintable cards.");
        if (whitelistEnabled) {
            require(verifyLeaf(proof, bytes32(keccak256(abi.encodePacked(msg.sender)))), "Not whitelisted");
        }

        /* ====================================================================================== */
        /*                                         EFFECTS                                        */
        /* ====================================================================================== */
        ids = new uint256[](count);

        for (uint8 i = 0; i < count; i++) {
            uint16 tokenPoolIdx = randomMintIdx();
            uint16 tokenPoolLastIdx = uint16(tokenPool.length) - 1;
            uint16 id = uint16(tokenPool[tokenPoolIdx]);

            // Pop and swap:
            if (tokenPoolIdx == tokenPoolLastIdx) {
                tokenPool.pop();
            } else {
                tokenPool[tokenPoolIdx] = tokenPool[tokenPoolLastIdx];
                tokenPool.pop();
            }

            ids[i] = id;
            mintCount[msg.sender]++;

            totalMinted++;

            if (totalMinted == TOTAL_COPIES_EVER) {
                mintingStatus = MintingStatus.DONE;
            }

            emit CardMinted(id, msg.sender);
        }

        /* ====================================================================================== */
        /*                                      INTERACTIONS                                      */
        /* ====================================================================================== */

        if (count == 1) {
            _mint(msg.sender, ids[0], 1, "");
        } else {
            uint256[] memory amounts = new uint256[](count);
            for (uint8 i = 0; i < count; i++) {
                amounts[i] = 1;
            }

            _mintBatch(msg.sender, ids, amounts, "");
        }

        return ids;
    }

    /* ------------------------------------ END STANDARD MINT ----------------------------------- */

    /* ----------------------------------- START ADVANCED MINT ---------------------------------- */
    function advancedMint(
        uint256[] calldata _ids,
        uint256 _expiryTimestamp,
        uint256 _nonce,
        bytes32 _messageHash,
        bytes calldata _signature
    ) external payable returns (uint256[] calldata) {
        /* ====================================================================================== */
        /*                                         CHECKS                                         */
        /* ====================================================================================== */
        require(mintingStatus == MintingStatus.ADVANCED);

        uint256 count = _ids.length;
        require(count > 0, "Must mint at least 1");
        require(msg.value == (.25 ether * count), "Incorrect price.");
        require(totalMinted + count <= TOTAL_COPIES_EVER, "Cannot mint more than total copies ever");
        require(mintCount[msg.sender] + count <= maxMintCountPerAddress, "Above max mintable cards.");

        require(tx.origin == msg.sender && !Address.isContract(msg.sender), "Contracts can't mint.");
        require(block.timestamp < _expiryTimestamp, "Expired timestamp, try again in a couple minutes.");
        require(ownerNonces[msg.sender] < _nonce, "Nonce already used.");

        /* ---------------------------------- SIGNATURE CHECKS ---------------------------------- */
        bytes32 ethSignedMessageHash = keccak256(
            abi.encodePacked(
                "\x19Ethereum Signed Message:\n32",
                keccak256(abi.encode(_ids, _expiryTimestamp, msg.sender, _nonce))
            )
        );
        require(_messageHash == ethSignedMessageHash, "Invalid message hash");
        require(ECDSA.recover(ethSignedMessageHash, _signature) == signer, "Invalid signature");

        /* ====================================================================================== */
        /*                                         EFFECTS                                        */
        /* ====================================================================================== */
        ownerNonces[msg.sender] = uint16(_nonce);

        for (uint8 i = 0; i < count; ++i) {
            mintCount[msg.sender]++;

            totalMinted++;

            if (totalMinted >= TOTAL_COPIES_EVER) {
                mintingStatus = MintingStatus.DONE;
            }

            emit CardMinted(_ids[i], msg.sender);
        }

        /* ====================================================================================== */
        /*                                      INTERACTIONS                                      */
        /* ====================================================================================== */
        if (count == 1) {
            _mint(msg.sender, _ids[0], 1, "");
        } else {
            uint256[] memory amounts = new uint256[](count);
            for (uint8 i = 0; i < count; i++) {
                amounts[i] = 1;
            }

            _mintBatch(msg.sender, _ids, amounts, "");
        }

        return _ids;
    }

    /* ============================================================================================================== */
    /*                                                   MARKETPLACE                                                  */
    /* ============================================================================================================== */
    function _beforeTokenTransfer(
        address operator,
        address from,
        address to,
        uint256[] memory ids,
        uint256[] memory amounts,
        bytes memory data
    ) internal virtual override(ERC1155) whenNotPaused {
        super._beforeTokenTransfer(operator, from, to, ids, amounts, data);
        if (from != address(0)) {
            uint16 length = uint16(ids.length);
            for (uint16 i = 0; i < length; i++) {
                uint16 amountOwned = uint16(balanceOf(from, ids[i]));
                uint16 amountSelling = uint16(_mondoMarketplace.getForSaleCount(ids[i], from));
                uint16 amountLeftAfterSales = amountOwned - amountSelling;
                uint16 amountToCancel = uint16(amounts[i]) - amountLeftAfterSales;

                if (amountToCancel > 0) {
                    _mondoMarketplace.cancelSaleToTransfer(from, ids[i], uint8(amountToCancel));
                }
            }
        }
    }

    function isApprovedForAll(address account, address operator) public view virtual override(ERC1155) returns (bool) {
        if (operator == address(_mondoMarketplace)) {
            return true;
        } else {
            return super.isApprovedForAll(account, operator);
        }
    }

    /* ============================================================================================================== */
    /*                                          ADMINISTRATIVE FUNCTIONALITY                                          */
    /* ============================================================================================================== */

    /* --------------------------------------- WITHDRAWING -------------------------------------- */
    function withdraw() external onlyRole(WITHDRAWER_ROLE) {
        uint256 balance = address(this).balance;
        (bool success, ) = msg.sender.call{value: balance}("");
        require(success, "Failed to send Ether");
    }

    function grantWithdrawerRole(address newWithdrawer) external onlyRole(DEFAULT_ADMIN_ROLE) {
        require(newWithdrawer != address(0), "Must provide a valid address");
        require(newWithdrawer != msg.sender, "Cannot grant yourself withdrawer role");
        require(!hasRole(WITHDRAWER_ROLE, newWithdrawer), "Already has withdrawer role");
        grantRole(WITHDRAWER_ROLE, newWithdrawer);
    }

    function removeWithdrawerRole(address oldWithdrawer) external onlyRole(DEFAULT_ADMIN_ROLE) {
        require(oldWithdrawer != address(0), "Must provide a valid address");
        require(oldWithdrawer != msg.sender, "Cannot remove yourself withdrawer role");
        require(hasRole(WITHDRAWER_ROLE, oldWithdrawer), "Does not have withdrawer role");
        revokeRole(WITHDRAWER_ROLE, oldWithdrawer);
    }

    /* --------------------------------------- MARKETPLACE -------------------------------------- */

    function setMondoMarketplace(address mondoMarketplaceAddress) external onlyRole(DEFAULT_ADMIN_ROLE) {
        _mondoMarketplace = MondoMarketplace(mondoMarketplaceAddress);
    }

    /* ------------------------------------ MINTING SETTINGS ------------------------------------ */

    function setWhitelist(bool enabled) external onlyRole(DEFAULT_ADMIN_ROLE) {
        whitelistEnabled = enabled;
    }

    function changeMerkleRoot(bytes32 newRoot) external onlyRole(DEFAULT_ADMIN_ROLE) {
        root = newRoot;
    }

    function changeSigner(address newSigner) external onlyRole(DEFAULT_ADMIN_ROLE) {
        signer = newSigner;
    }

    function setMintingStatus(MintingStatus status) external onlyRole(DEFAULT_ADMIN_ROLE) {
        mintingStatus = status;
    }

    function changeMaxMintCountPerAddress(uint8 newMaxMintCountPerAddress) external onlyRole(DEFAULT_ADMIN_ROLE) {
        maxMintCountPerAddress = newMaxMintCountPerAddress;
    }

    /* ----------------------------------------- PAUSING ---------------------------------------- */

    function pause() external onlyRole(PAUSER_ROLE) {
        _pause();
    }

    function unpause() external onlyRole(PAUSER_ROLE) {
        _unpause();
    }

    function grantPauserRole(address newPauser) external onlyRole(DEFAULT_ADMIN_ROLE) {
        require(newPauser != address(0), "Must provide a valid address");
        require(newPauser != msg.sender, "Cannot grant yourself pauser role");
        require(!hasRole(PAUSER_ROLE, newPauser), "Already has pauser role");
        grantRole(PAUSER_ROLE, newPauser);
    }

    function removePauserRole(address oldPauser) external onlyRole(DEFAULT_ADMIN_ROLE) {
        require(oldPauser != address(0), "Must provide a valid address");
        require(oldPauser != msg.sender, "Cannot remove yourself from the pauser role");
        require(hasRole(PAUSER_ROLE, oldPauser), "Does not have pauser role");
        revokeRole(PAUSER_ROLE, oldPauser);
    }
}