{"SourceCode": "# @version 0.3.10\r\n\r\n\"\"\"\r\n@title Vesting Escrow Factory\r\n@author Curve Finance, Yearn Finance\r\n@license MIT\r\n@notice Stores and distributes ERC20 tokens by deploying `VestingEscrowSimple` contracts\r\n\"\"\"\r\n\r\nfrom vyper.interfaces import ERC20\r\n\r\n\r\ninterface VestingEscrowSimple:\r\n    def initialize(\r\n        owner: address,\r\n        token: ERC20,\r\n        recipient: address,\r\n        amount: uint256,\r\n        start_time: uint256,\r\n        end_time: uint256,\r\n        cliff_length: uint256,\r\n        open_claim: bool,\r\n    ) -> bool: nonpayable\r\n\r\n\r\nevent VestingEscrowCreated:\r\n    funder: indexed(address)\r\n    token: indexed(ERC20)\r\n    recipient: indexed(address)\r\n    escrow: address\r\n    amount: uint256\r\n    vesting_start: uint256\r\n    vesting_duration: uint256\r\n    cliff_length: uint256\r\n    open_claim: bool\r\n\r\n\r\nTARGET: public(immutable(address))\r\nVYPER: public(immutable(address))\r\n\r\n\r\n@external\r\ndef __init__(target: address, vyper_donate: address):\r\n    \"\"\"\r\n    @notice Contract constructor\r\n    @dev Prior to deployment you must deploy one copy of `VestingEscrowSimple` which\r\n         is used as a library for vesting contracts deployed by this factory\r\n    @param target `VestingEscrowSimple` contract address\r\n    @param vyper_donate Vyper Safe address for donations (vyperlang.eth on mainnet)\r\n    \"\"\"\r\n    TARGET = target\r\n    VYPER = vyper_donate\r\n\r\n\r\n@external\r\ndef deploy_vesting_contract(\r\n    token: ERC20,\r\n    recipient: address,\r\n    amount: uint256,\r\n    vesting_duration: uint256,\r\n    vesting_start: uint256 = block.timestamp,\r\n    cliff_length: uint256 = 0,\r\n    open_claim: bool = True,\r\n    support_vyper: uint256 = 100,\r\n    owner: address = msg.sender,\r\n) -> address:\r\n    \"\"\"\r\n    @notice Deploy a new vesting contract\r\n    @dev Prior to deployment you must approve `amount` + `amount` * `support_vyper` / 10_000\r\n         tokens\r\n    @param token ERC20 token being distributed\r\n    @param recipient Address to vest tokens for\r\n    @param amount Amount of tokens being vested for `recipient`\r\n    @param vesting_duration Time period (in seconds) over which tokens are released\r\n    @param vesting_start Epoch time when tokens begin to vest\r\n    @param open_claim Switch if anyone can claim for `recipient`\r\n    @param support_vyper Donation percentage in bps, 1% by default\r\n    @param owner Vesting contract owner\r\n    \"\"\"\r\n    assert cliff_length <= vesting_duration  # dev: incorrect vesting cliff\r\n    assert vesting_start + vesting_duration > block.timestamp  # dev: just use a transfer, dummy\r\n    assert vesting_duration > 0  # dev: duration must be > 0\r\n    assert recipient not in [self, empty(address), token.address, owner]  # dev: wrong recipient\r\n\r\n    escrow: address = create_minimal_proxy_to(TARGET)\r\n\r\n    VestingEscrowSimple(escrow).initialize(\r\n        owner,\r\n        token,\r\n        recipient,\r\n        amount,\r\n        vesting_start,\r\n        vesting_start + vesting_duration,\r\n        cliff_length,\r\n        open_claim,\r\n    )\r\n    # skip transferFrom and approve and send directly to escrow\r\n    assert token.transferFrom(msg.sender, escrow, amount, default_return_value=True)  # dev: funding failed\r\n    if support_vyper > 0:\r\n        assert VYPER != empty(address)  # dev: lost donation\r\n        assert token.transferFrom(\r\n            msg.sender,\r\n            VYPER,\r\n            amount * support_vyper / 10_000,\r\n            default_return_value=True\r\n        )  # dev: donation failed\r\n\r\n    log VestingEscrowCreated(\r\n        msg.sender,\r\n        token,\r\n        recipient,\r\n        escrow,\r\n        amount,\r\n        vesting_start,\r\n        vesting_duration,\r\n        cliff_length,\r\n        open_claim,\r\n    )\r\n    return escrow", "ABI": "[{\"name\":\"VestingEscrowCreated\",\"inputs\":[{\"name\":\"funder\",\"type\":\"address\",\"indexed\":true},{\"name\":\"token\",\"type\":\"address\",\"indexed\":true},{\"name\":\"recipient\",\"type\":\"address\",\"indexed\":true},{\"name\":\"escrow\",\"type\":\"address\",\"indexed\":false},{\"name\":\"amount\",\"type\":\"uint256\",\"indexed\":false},{\"name\":\"vesting_start\",\"type\":\"uint256\",\"indexed\":false},{\"name\":\"vesting_duration\",\"type\":\"uint256\",\"indexed\":false},{\"name\":\"cliff_length\",\"type\":\"uint256\",\"indexed\":false},{\"name\":\"open_claim\",\"type\":\"bool\",\"indexed\":false}],\"anonymous\":false,\"type\":\"event\"},{\"stateMutability\":\"nonpayable\",\"type\":\"constructor\",\"inputs\":[{\"name\":\"target\",\"type\":\"address\"},{\"name\":\"vyper_donate\",\"type\":\"address\"}],\"outputs\":[]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"deploy_vesting_contract\",\"inputs\":[{\"name\":\"token\",\"type\":\"address\"},{\"name\":\"recipient\",\"type\":\"address\"},{\"name\":\"amount\",\"type\":\"uint256\"},{\"name\":\"vesting_duration\",\"type\":\"uint256\"}],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"deploy_vesting_contract\",\"inputs\":[{\"name\":\"token\",\"type\":\"address\"},{\"name\":\"recipient\",\"type\":\"address\"},{\"name\":\"amount\",\"type\":\"uint256\"},{\"name\":\"vesting_duration\",\"type\":\"uint256\"},{\"name\":\"vesting_start\",\"type\":\"uint256\"}],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"deploy_vesting_contract\",\"inputs\":[{\"name\":\"token\",\"type\":\"address\"},{\"name\":\"recipient\",\"type\":\"address\"},{\"name\":\"amount\",\"type\":\"uint256\"},{\"name\":\"vesting_duration\",\"type\":\"uint256\"},{\"name\":\"vesting_start\",\"type\":\"uint256\"},{\"name\":\"cliff_length\",\"type\":\"uint256\"}],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"deploy_vesting_contract\",\"inputs\":[{\"name\":\"token\",\"type\":\"address\"},{\"name\":\"recipient\",\"type\":\"address\"},{\"name\":\"amount\",\"type\":\"uint256\"},{\"name\":\"vesting_duration\",\"type\":\"uint256\"},{\"name\":\"vesting_start\",\"type\":\"uint256\"},{\"name\":\"cliff_length\",\"type\":\"uint256\"},{\"name\":\"open_claim\",\"type\":\"bool\"}],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"deploy_vesting_contract\",\"inputs\":[{\"name\":\"token\",\"type\":\"address\"},{\"name\":\"recipient\",\"type\":\"address\"},{\"name\":\"amount\",\"type\":\"uint256\"},{\"name\":\"vesting_duration\",\"type\":\"uint256\"},{\"name\":\"vesting_start\",\"type\":\"uint256\"},{\"name\":\"cliff_length\",\"type\":\"uint256\"},{\"name\":\"open_claim\",\"type\":\"bool\"},{\"name\":\"support_vyper\",\"type\":\"uint256\"}],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"deploy_vesting_contract\",\"inputs\":[{\"name\":\"token\",\"type\":\"address\"},{\"name\":\"recipient\",\"type\":\"address\"},{\"name\":\"amount\",\"type\":\"uint256\"},{\"name\":\"vesting_duration\",\"type\":\"uint256\"},{\"name\":\"vesting_start\",\"type\":\"uint256\"},{\"name\":\"cliff_length\",\"type\":\"uint256\"},{\"name\":\"open_claim\",\"type\":\"bool\"},{\"name\":\"support_vyper\",\"type\":\"uint256\"},{\"name\":\"owner\",\"type\":\"address\"}],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"TARGET\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"VYPER\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]}]", "ContractName": "Vesting Escrow Factory", "CompilerVersion": "vyper:0.3.10", "OptimizationUsed": "0", "Runs": "0", "ConstructorArguments": "0000000000000000000000009692f652a3048eb7f5074e12b907f20d33f37a0100000000000000000000000070ccbe10f980d80b7ebaab7d2e3a73e87d67b775", "EVMVersion": "Default", "Library": "", "LicenseType": "MIT", "Proxy": "0", "Implementation": "", "SwarmSource": ""}