{"SourceCode": "/**\r\n*/\r\n\r\n// SPDX-License-Identifier: MIT\r\npragma solidity 0.8.19;\r\n\r\n\r\ninterface IERC20 {\r\n    function balanceOf(address account) external view returns (uint);\r\n\r\n    function transfer(address recipient, uint amount) external returns (bool);\r\n\r\n    function transferFrom(address sender, address recipient, uint amount) external returns (bool);\r\n}\r\n\r\n\r\nabstract contract Context {\r\n    function _msgSender() internal view returns (address) {\r\n        return msg.sender;\r\n    }\r\n}\r\n\r\nabstract contract Ownable is Context {\r\n    address private _owner;\r\n\r\n    event OwnershipTransferred(\r\n        address indexed previousOwner,\r\n        address indexed newOwner\r\n    );\r\n\r\n    constructor() {\r\n        _transferOwnership(_msgSender());\r\n    }\r\n\r\n    modifier onlyOwner() {\r\n        _checkOwner();\r\n        _;\r\n    }\r\n\r\n    function owner() public view returns (address) {\r\n        return _owner;\r\n    }\r\n\r\n    function _checkOwner() private view {\r\n        require(owner() == _msgSender(), \"Ownable: caller is not the owner\");\r\n    }\r\n\r\n    function renounceOwnership() external onlyOwner {\r\n        _transferOwnership(address(0));\r\n    }\r\n\r\n    function transferOwnership(address newOwner) external onlyOwner {\r\n        require(\r\n            newOwner != address(0),\r\n            \"Ownable: new owner is the zero address\"\r\n        );\r\n        _transferOwnership(newOwner);\r\n    }\r\n\r\n    function _transferOwnership(address newOwner) private {\r\n        address oldOwner = _owner;\r\n        _owner = newOwner;\r\n        emit OwnershipTransferred(oldOwner, newOwner);\r\n    }\r\n}\r\n\r\nabstract contract ReentrancyGuard {\r\n    uint256 private constant _NOT_ENTERED = 1;\r\n    uint256 private constant _ENTERED = 2;\r\n\r\n    uint256 private _status;\r\n\r\n    constructor() {\r\n        _status = _NOT_ENTERED;\r\n    }\r\n\r\n    modifier nonReentrant() {\r\n        _nonReentrantBefore();\r\n        _;\r\n        _nonReentrantAfter();\r\n    }\r\n\r\n    function _nonReentrantBefore() private {\r\n        require(_status != _ENTERED, \"ReentrancyGuard: reentrant call\");\r\n\r\n        _status = _ENTERED;\r\n    }\r\n\r\n    function _nonReentrantAfter() private {\r\n        _status = _NOT_ENTERED;\r\n    }\r\n\r\n    function _reentrancyGuardEntered() private view returns (bool) {\r\n        return _status == _ENTERED;\r\n    }\r\n}\r\n\r\n\r\n\r\ncontract PEPEINUStaking is Ownable, ReentrancyGuard {\r\n    struct PoolInfo {\r\n        uint256 lockupDuration;\r\n        uint256 returnPer;\r\n    }\r\n    struct OrderInfo {\r\n        address beneficiary;\r\n        uint256 amount;\r\n        uint256 lockupDuration;\r\n        uint256 returnPer;\r\n        uint256 starttime;\r\n        uint256 endtime;\r\n        uint256 claimedReward;\r\n        bool claimed;\r\n    }\r\n    uint256 private constant _days7 = 7 days;\r\n    uint256 private constant _days14 = 14 days;\r\n    uint256 private constant _days365 = 365 days;\r\n    IERC20 public token;\r\n    bool public started = true;\r\n    uint256 public emergencyWithdrawFeesPercentage = 0;\r\n\r\n    uint256 private _7daysPercentage = 1080;\r\n    uint256 private _14daysPercentage = 1180;\r\n\r\n    uint256 private latestOrderId = 0;\r\n    uint public totalStakers ; // use \r\n    uint public totalStaked ; // use \r\n    uint256 public totalStake = 0;\r\n    uint256 public totalWithdrawal = 0;\r\n    uint256 public totalRewardPending = 0;\r\n    uint256 public totalRewardsDistribution = 0;\r\n\r\n    mapping(uint256 => PoolInfo) public pooldata;\r\n    mapping(address => uint256) public balanceOf;\r\n    mapping(address => uint256) public totalRewardEarn;\r\n    mapping(uint256 => OrderInfo) public orders;\r\n    mapping(address => uint256[]) private orderIds;\r\n\r\n    mapping(address => mapping(uint => bool)) public hasStaked;\r\n    mapping(uint => uint) public stakeOnPool;\r\n    mapping(uint => uint) public rewardOnPool;\r\n    mapping(uint => uint) public stakersPlan;\r\n\r\n    event Deposit(\r\n        address indexed user,\r\n        uint256 indexed lockupDuration,\r\n        uint256 amount,\r\n        uint256 returnPer\r\n    );\r\n    event Withdraw(\r\n        address indexed user,\r\n        uint256 amount,\r\n        uint256 reward,\r\n        uint256 total\r\n    );\r\n    event WithdrawAll(address indexed user, uint256 amount);\r\n    event RewardClaimed(address indexed user, uint256 reward);\r\n    event RefRewardClaimed(address indexed user, uint256 reward);\r\n\r\n    constructor(address _token, bool _started) {\r\n        token = IERC20(_token);\r\n        started = _started;\r\n\r\n        pooldata[7].lockupDuration = _days7; // 7 days\r\n        pooldata[7].returnPer = _7daysPercentage;\r\n\r\n        pooldata[14].lockupDuration = _days14; // 14 days\r\n        pooldata[14].returnPer = _14daysPercentage;\r\n\r\n\r\n    }\r\n\r\n    function deposit(\r\n        uint256 _amount,\r\n        uint256 _lockupDuration\r\n    ) external {\r\n\r\n\r\n        PoolInfo storage pool = pooldata[_lockupDuration];\r\n        require(\r\n            pool.lockupDuration > 0,\r\n            \"TokenStakingSAFU: asked pool does not exist\"\r\n        );\r\n        require(started, \"TokenStakingSAFU: staking not yet started\");\r\n        require(_amount > 0, \"TokenStakingSAFU: stake amount must be non zero\");\r\n\r\n        uint256 APY = (_amount * pool.returnPer) / 100;\r\n        uint256 userReward = (APY * pool.lockupDuration) / _days365;\r\n        uint256 requiredToken = (totalStake - totalWithdrawal) +\r\n            totalRewardPending +\r\n            userReward;\r\n        require(\r\n            requiredToken <= token.balanceOf(address(this)),\r\n            \"TokenStakingSAFU: insufficient contract balance to return rewards\"\r\n        );\r\n        require(\r\n            token.transferFrom(_msgSender(), address(this), _amount),\r\n            \"TokenStakingSAFU: token transferFrom via deposit not succeeded\"\r\n        );\r\n\r\n        orders[++latestOrderId] = OrderInfo(\r\n            _msgSender(),\r\n            _amount,\r\n            pool.lockupDuration,\r\n            pool.returnPer,\r\n            block.timestamp,\r\n            block.timestamp + pool.lockupDuration,\r\n            0,\r\n            false\r\n        );\r\n\r\n          if (!hasStaked[msg.sender][_lockupDuration]) {\r\n             stakersPlan[_lockupDuration] = stakersPlan[_lockupDuration] + 1;\r\n             totalStakers = totalStakers + 1 ;\r\n        }\r\n\r\n        hasStaked[msg.sender][_lockupDuration] = true;\r\n        stakeOnPool[_lockupDuration] = stakeOnPool[_lockupDuration] + _amount ;\r\n        totalStaked = totalStaked + _amount ;\r\n        totalStake += _amount;\r\n        totalRewardPending += userReward;\r\n        balanceOf[_msgSender()] += _amount;\r\n        orderIds[_msgSender()].push(latestOrderId);\r\n        emit Deposit(\r\n            _msgSender(),\r\n            pool.lockupDuration,\r\n            _amount,\r\n            pool.returnPer\r\n        );\r\n    }\r\n\r\n\r\n    function withdraw(uint256 orderId) external nonReentrant {\r\n        require(\r\n            orderId <= latestOrderId,\r\n            \"TokenStakingSAFU: INVALID orderId, orderId greater than latestOrderId\"\r\n        );\r\n\r\n        OrderInfo storage orderInfo = orders[orderId];\r\n        require(\r\n            _msgSender() == orderInfo.beneficiary,\r\n            \"TokenStakingSAFU: caller is not the beneficiary\"\r\n        );\r\n        require(!orderInfo.claimed, \"TokenStakingSAFU: order already unstaked\");\r\n    \r\n        uint256 claimAvailable = pendingRewards(orderId);\r\n        uint256 total = orderInfo.amount + claimAvailable;\r\n\r\n        totalRewardEarn[_msgSender()] += claimAvailable;\r\n        totalRewardsDistribution += claimAvailable;\r\n        orderInfo.claimedReward += claimAvailable;\r\n        totalRewardPending -= claimAvailable;\r\n\r\n        balanceOf[_msgSender()] -= orderInfo.amount;\r\n        totalWithdrawal += orderInfo.amount;\r\n        orderInfo.claimed = true;\r\n\r\n        require(\r\n            token.transfer(address(_msgSender()), total),\r\n            \"TokenStakingSAFU: token transfer via withdraw not succeeded\"\r\n        );\r\n        rewardOnPool[orderInfo.lockupDuration] = rewardOnPool[orderInfo.lockupDuration] + claimAvailable ;\r\n        emit Withdraw(_msgSender(), orderInfo.amount, claimAvailable, total);\r\n    }\r\n\r\n\r\n    function claimRewards(uint256 orderId) external nonReentrant {\r\n        require(\r\n            orderId <= latestOrderId,\r\n            \"TokenStakingSAFU: INVALID orderId, orderId greater than latestOrderId\"\r\n        );\r\n\r\n        OrderInfo storage orderInfo = orders[orderId];\r\n        require(\r\n            _msgSender() == orderInfo.beneficiary,\r\n            \"TokenStakingSAFU: caller is not the beneficiary\"\r\n        );\r\n        require(!orderInfo.claimed, \"TokenStakingSAFU: order already unstaked\");\r\n\r\n        uint256 claimAvailable = pendingRewards(orderId);\r\n        totalRewardEarn[_msgSender()] += claimAvailable;\r\n        totalRewardsDistribution += claimAvailable;\r\n        totalRewardPending -= claimAvailable;\r\n        orderInfo.claimedReward += claimAvailable;\r\n\r\n        require(\r\n            token.transfer(address(_msgSender()), claimAvailable),\r\n            \"TokenStakingSAFU: token transfer via claim rewards not succeeded\"\r\n        );\r\n        rewardOnPool[orderInfo.lockupDuration] = rewardOnPool[orderInfo.lockupDuration] + claimAvailable ;\r\n        emit RewardClaimed(address(_msgSender()), claimAvailable);\r\n    }\r\n\r\n    function pendingRewards(uint256 orderId) public view returns (uint256) {\r\n        require(\r\n            orderId <= latestOrderId,\r\n            \"TokenStakingSAFU: INVALID orderId, orderId greater than latestOrderId\"\r\n        );\r\n\r\n        OrderInfo storage orderInfo = orders[orderId];\r\n        if (!orderInfo.claimed) {\r\n            if (block.timestamp >= orderInfo.endtime) {\r\n                uint256 APY = (orderInfo.amount * orderInfo.returnPer) / 100;\r\n                uint256 reward = (APY * orderInfo.lockupDuration) / _days365;\r\n                uint256 claimAvailable = reward - orderInfo.claimedReward;\r\n                return claimAvailable;\r\n            } else {\r\n                uint256 stakeTime = block.timestamp - orderInfo.starttime;\r\n                uint256 APY = (orderInfo.amount * orderInfo.returnPer) / 100;\r\n                uint256 reward = (APY * stakeTime) / _days365;\r\n                uint256 claimAvailableNow = reward - orderInfo.claimedReward;\r\n                return claimAvailableNow;\r\n            }\r\n        } else {\r\n            return 0;\r\n        }\r\n    }\r\n\r\n    function toggleStaking(bool _start) external onlyOwner returns (bool) {\r\n        started = _start;\r\n        return true;\r\n    }\r\n\r\n    function investorOrderIds(\r\n        address investor\r\n    ) external view returns (uint256[] memory ids) {\r\n        uint256[] memory arr = orderIds[investor];\r\n        return arr;\r\n    }\r\n\r\n    function _totalRewards(address ref) private view returns (uint256) {\r\n        uint256 rewards;\r\n        uint256[] memory arr = orderIds[ref];\r\n        for (uint256 i = 0; i < arr.length; i++) {\r\n            OrderInfo memory order = orders[arr[i]];\r\n            rewards += (order.claimedReward + pendingRewards(arr[i]));\r\n        }\r\n        return rewards;\r\n    }\r\n\r\n\r\n    function transferAnyERC20Token(\r\n        address payaddress,\r\n        address tokenAddress,\r\n        uint256 amount\r\n    ) external onlyOwner {\r\n        IERC20(tokenAddress).transfer(payaddress, amount);\r\n    }\r\n}", "ABI": "[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_token\",\"type\":\"address\"},{\"internalType\":\"bool\",\"name\":\"_started\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"lockupDuration\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"returnPer\",\"type\":\"uint256\"}],\"name\":\"Deposit\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"previousOwner\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"OwnershipTransferred\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"reward\",\"type\":\"uint256\"}],\"name\":\"RefRewardClaimed\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"reward\",\"type\":\"uint256\"}],\"name\":\"RewardClaimed\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"reward\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"total\",\"type\":\"uint256\"}],\"name\":\"Withdraw\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"WithdrawAll\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"balanceOf\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"orderId\",\"type\":\"uint256\"}],\"name\":\"claimRewards\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_lockupDuration\",\"type\":\"uint256\"}],\"name\":\"deposit\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"emergencyWithdrawFeesPercentage\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"hasStaked\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"investor\",\"type\":\"address\"}],\"name\":\"investorOrderIds\",\"outputs\":[{\"internalType\":\"uint256[]\",\"name\":\"ids\",\"type\":\"uint256[]\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"orders\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"beneficiary\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"lockupDuration\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"returnPer\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"starttime\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"endtime\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"claimedReward\",\"type\":\"uint256\"},{\"internalType\":\"bool\",\"name\":\"claimed\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"orderId\",\"type\":\"uint256\"}],\"name\":\"pendingRewards\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"pooldata\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"lockupDuration\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"returnPer\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"renounceOwnership\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"rewardOnPool\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"stakeOnPool\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"stakersPlan\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"started\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bool\",\"name\":\"_start\",\"type\":\"bool\"}],\"name\":\"toggleStaking\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"token\",\"outputs\":[{\"internalType\":\"contract IERC20\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"totalRewardEarn\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"totalRewardPending\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"totalRewardsDistribution\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"totalStake\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"totalStaked\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"totalStakers\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"totalWithdrawal\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"payaddress\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"tokenAddress\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"transferAnyERC20Token\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"transferOwnership\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"orderId\",\"type\":\"uint256\"}],\"name\":\"withdraw\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}]", "ContractName": "PEPEINUStaking", "CompilerVersion": "v0.8.19+commit.7dd6d404", "OptimizationUsed": "0", "Runs": "200", "ConstructorArguments": "0000000000000000000000008dc2906de0d7409c3cace9482fbffd566639c5930000000000000000000000000000000000000000000000000000000000000001", "EVMVersion": "Default", "Library": "", "LicenseType": "MIT", "Proxy": "0", "Implementation": "", "SwarmSource": "ipfs://cf8fadc3a156132792b965b029d6fe54be02b610d923882fa542d07886222787"}