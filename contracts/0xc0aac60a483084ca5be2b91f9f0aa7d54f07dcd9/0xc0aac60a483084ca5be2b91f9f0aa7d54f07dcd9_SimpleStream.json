{"SourceCode": "// Sources flattened with hardhat v2.1.1 https://hardhat.org\r\n\r\n// File contracts/SimpleStream.sol\r\n// https://github.com/austintgriffith/scaffold-eth/tree/simple-stream\r\n\r\n//\r\n// \ud83c\udff0 BuidlGuidl.com\r\n//\r\n\r\n\r\npragma solidity >=0.8.0;\r\n//SPDX-License-Identifier: MIT\r\n\r\n//import \"hardhat/console.sol\";\r\n\r\ncontract SimpleStream {\r\n\r\n  event Withdraw( address indexed to, uint256 amount, string reason );\r\n  event Deposit( address indexed from, uint256 amount, string reason );\r\n\r\n  address payable public toAddress;// = payable(0xD75b0609ed51307E13bae0F9394b5f63A7f8b6A1);\r\n  uint256 public cap;// = 0.5 ether;\r\n  uint256 public frequency;// 1296000 seconds == 2 weeks;\r\n  uint256 public last;//stream starts empty (last = block.timestamp) or full (block.timestamp - frequency)\r\n\r\n  constructor(address payable _toAddress, uint256 _cap, uint256 _frequency, bool _startsFull) {\r\n    toAddress = _toAddress;\r\n    cap = _cap;\r\n    frequency = _frequency;\r\n    if(_startsFull){\r\n      last = block.timestamp - frequency;\r\n    }else{\r\n      last = block.timestamp;\r\n    }\r\n  }\r\n\r\n  function streamBalance() public view returns (uint256){\r\n    if(block.timestamp-last > frequency){\r\n      return cap;\r\n    }\r\n    return (cap * (block.timestamp-last)) / frequency;\r\n  }\r\n\r\n  function streamWithdraw(uint256 amount, string memory reason) public {\r\n     require(msg.sender==toAddress,\"this stream is not for you\");\r\n     uint256 totalAmountCanWithdraw = streamBalance();\r\n     require(totalAmountCanWithdraw>=amount,\"not enough in the stream\");\r\n     uint256 cappedLast = block.timestamp-frequency;\r\n     if(last<cappedLast){\r\n       last = cappedLast;\r\n     }\r\n     last = last + ((block.timestamp - last) * amount / totalAmountCanWithdraw);\r\n     emit Withdraw( msg.sender, amount, reason );\r\n     toAddress.transfer(amount);\r\n   }\r\n\r\n   function streamDeposit(string memory reason) public payable {\r\n      emit Deposit( msg.sender, msg.value, reason );\r\n   }\r\n\r\n   receive() external payable { streamDeposit(\"\"); }\r\n}", "ABI": "[{\"inputs\":[{\"internalType\":\"address payable\",\"name\":\"_toAddress\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"_cap\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_frequency\",\"type\":\"uint256\"},{\"internalType\":\"bool\",\"name\":\"_startsFull\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"from\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"string\",\"name\":\"reason\",\"type\":\"string\"}],\"name\":\"Deposit\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"string\",\"name\":\"reason\",\"type\":\"string\"}],\"name\":\"Withdraw\",\"type\":\"event\"},{\"inputs\":[],\"name\":\"cap\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"frequency\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"last\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"streamBalance\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"string\",\"name\":\"reason\",\"type\":\"string\"}],\"name\":\"streamDeposit\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"internalType\":\"string\",\"name\":\"reason\",\"type\":\"string\"}],\"name\":\"streamWithdraw\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"toAddress\",\"outputs\":[{\"internalType\":\"address payable\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}]", "ContractName": "SimpleStream", "CompilerVersion": "v0.8.4+commit.c7e474f2", "OptimizationUsed": "1", "Runs": "200", "ConstructorArguments": "00000000000000000000000034aa3f359a9d614239015126635ce7732c18fdf30000000000000000000000000000000000000000000000001bc16d674ec80000000000000000000000000000000000000000000000000000000000000013c6800000000000000000000000000000000000000000000000000000000000000000", "EVMVersion": "Default", "Library": "", "LicenseType": "MIT", "Proxy": "0", "Implementation": "", "SwarmSource": "ipfs://998fd3296a17e6fc1e79b14215371f2ae91a0a88a0ca053c18e4bbb8872216b6"}