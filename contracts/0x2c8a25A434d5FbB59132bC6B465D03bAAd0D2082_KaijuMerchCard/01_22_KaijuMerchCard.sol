// SPDX-License-Identifier: Unlicense

pragma solidity ^0.8.0;

import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/token/ERC721/ERC721.sol";

import "./interfaces/IKaijuMart.sol";

error KaijuMerchCard_MustBeAKing();

/**
                        .             :++-
                       *##-          +####*          -##+
                       *####-      :%######%.      -%###*
                       *######:   =##########=   .######*
                       *#######*-#############*-*#######*
                       *################################*
                       *################################*
                       *################################*
                       *################################*
                       *################################*
                       :*******************************+.

                .:.
               *###%*=:
              .##########+-.
              +###############=:
              %##################%+
             =######################
             -######################++++++++++++++++++=-:
              =###########################################*:
               =#############################################.
  +####%#*+=-:. -#############################################:
  %############################################################=
  %##############################################################
  %##############################################################%=----::.
  %#######################################################################%:
  %##########################################+:    :+%#######################:
  *########################################*          *#######################
   -%######################################            %######################
     -%###################################%            #######################
       =###################################-          :#######################
     ....+##################################*.      .+########################
  +###########################################%*++*%##########################
  %#########################################################################*.
  %#######################################################################+
  ########################################################################-
  *#######################################################################-
  .######################################################################%.
     :+#################################################################-
         :=#####################################################:.....
             :--:.:##############################################+
   ::             +###############################################%-
  ####%+-.        %##################################################.
  %#######%*-.   :###################################################%
  %###########%*=*####################################################=
  %####################################################################
  %####################################################################+
  %#####################################################################.
  %#####################################################################%
  %######################################################################-
  .+*********************************************************************.
 * @title KaijuMart Essentials Merch Card
 * @author Augminted Labs, LLC
 */
contract KaijuMerchCard is ERC721, Ownable {
    IKaijuMart public kmart;
    string public baseURI;

    constructor(
        IKaijuMart _kmart,
        string memory _uri,
        address admin
    )
        ERC721("KaijuMerchCard", "ESSENTIALS")
    {
        _transferOwnership(admin);

        kmart = _kmart;
        baseURI = _uri;
    }

    /**
     * @notice Overrides to prevent use of transfer functionality
     */
    function approve(address to, uint256 tokenId) public virtual override {}
    function setApprovalForAll(address operator, bool approved) public virtual override {}
    function transferFrom(address from, address to, uint256 tokenId) public virtual override {}
    function safeTransferFrom(address from, address to, uint256 tokenId) public virtual override {}
    function safeTransferFrom(address from, address to, uint256 tokenId, bytes memory _data) public virtual override {}

    /**
     * @inheritdoc ERC721
     */
    function _baseURI() internal view virtual override returns (string memory) {
        return baseURI;
    }

    /**
     * @notice Set token URI
     * @param uri New token URI
     */
    function setBaseURI(string calldata uri) public onlyOwner {
        baseURI = uri;
    }

    /**
     * @notice Mint a soulbound merch card token
     */
    function mint() public {
        if (!kmart.isKing(_msgSender())) revert KaijuMerchCard_MustBeAKing();

        _mint(_msgSender(), uint256(uint160(_msgSender())));
    }
}